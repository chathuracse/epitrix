<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fit discretised distributions using ML — fit_disc_gamma • epitrix</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Fit discretised distributions using ML — fit_disc_gamma" />

<meta property="og:description" content="These functions performs maximum-likelihood (ML) fitting of a discretised
distribution. This is typically useful for describing delays between
epidemiological events, such as incubation period (infection to onset) or
serial intervals (primary to secondary onsets). The function
optim is used internally for fitting." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">epitrix</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/epitrix.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit discretised distributions using ML</h1>
    
    <div class="hidden name"><code>fit_disc_gamma.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>These functions performs maximum-likelihood (ML) fitting of a discretised
distribution. This is typically useful for describing delays between
epidemiological events, such as incubation period (infection to onset) or
serial intervals (primary to secondary onsets). The function
<code><a href='https://www.rdocumentation.org/packages/stats/topics/optim'>optim</a></code> is used internally for fitting.</p>
    
    </div>

    <pre class="usage"><span class='fu'>fit_disc_gamma</span>(<span class='no'>x</span>, <span class='kw'>mu_ini</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>cv_ini</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>interval</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>w</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A vector of numeric data to fit; NAs will be removed with a warning.</p></td>
    </tr>
    <tr>
      <th>mu_ini</th>
      <td><p>The initial value for the mean 'mu', defaulting to 1.</p></td>
    </tr>
    <tr>
      <th>cv_ini</th>
      <td><p>The initial value for the coefficient of variation 'cv',
defaulting to 1.</p></td>
    </tr>
    <tr>
      <th>interval</th>
      <td><p>The interval used for discretisation; see <code>distcrete</code>.</p></td>
    </tr>
    <tr>
      <th>w</th>
      <td><p>The centering of the interval used for discretisation; see
<code>distcrete</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further arguments passed to <code><a href='https://www.rdocumentation.org/packages/stats/topics/optim'>optim</a></code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The function returns a list with human-readable parametrisation of
  the discretised Gamma distibution (mean, sd, cv), convergence indicators,
  and the discretised Gamma distribution itself as a <code>distcrete</code> object
  (from the <code>distcrete</code> package).</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>The <code>distcrete</code> package for discretising distributions, and
<code><a href='https://www.rdocumentation.org/packages/stats/topics/optim'>optim</a></code> for details on available optimisation procedures.</p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## generate data</span>

<span class='no'>mu</span> <span class='kw'>&lt;-</span> <span class='fl'>15.3</span> <span class='co'># days</span>
<span class='no'>sigma</span> <span class='kw'>&lt;-</span> <span class='fl'>9.3</span> <span class='co'># days</span>
<span class='no'>cv</span> <span class='kw'>&lt;-</span> <span class='no'>mu</span> / <span class='no'>sigma</span>
<span class='no'>cv</span></div><div class='output co'>#&gt; [1] 1.645161</div><div class='input'><span class='no'>param</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='gamma_tools.html'>gamma_mucv2shapescale</a></span>(<span class='no'>mu</span>, <span class='no'>cv</span>)

<span class='kw'>if</span> (<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>require</a></span>(<span class='no'>distcrete</span>)) {
<span class='no'>w</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/distcrete/topics/distcrete'>distcrete</a></span>(<span class='st'>"gamma"</span>, <span class='kw'>interval</span> <span class='kw'>=</span> <span class='fl'>1</span>,
               <span class='kw'>shape</span> <span class='kw'>=</span> <span class='no'>param</span>$<span class='no'>shape</span>,
               <span class='kw'>scale</span> <span class='kw'>=</span> <span class='no'>param</span>$<span class='no'>scale</span>, <span class='kw'>w</span> <span class='kw'>=</span> <span class='fl'>0</span>)

<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='no'>w</span>$<span class='fu'>r</span>(<span class='fl'>100</span>)
<span class='no'>x</span>

<span class='fu'>fit_disc_gamma</span>(<span class='no'>x</span>)
}</div><div class='output co'>#&gt; <span class='message'>Loading required package: distcrete</span></div><div class='output co'>#&gt; $mu
#&gt; [1] 13.79959
#&gt; 
#&gt; $cv
#&gt; [1] 1.66056
#&gt; 
#&gt; $sd
#&gt; [1] 22.91505
#&gt; 
#&gt; $ll
#&gt; [1] -328.9847
#&gt; 
#&gt; $converged
#&gt; [1] TRUE
#&gt; 
#&gt; $distribution
#&gt; A discrete distribution
#&gt;   name: gamma
#&gt;   parameters:
#&gt;     shape: 0.362652647447292
#&gt;     scale: 38.0518219274635
#&gt; </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Thibaut Jombart <a href='mailto:thibautjombart@gmail.com'>thibautjombart@gmail.com</a></p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Thibaut Jombart, Anne Cori.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

