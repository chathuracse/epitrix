<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Reparameterise Gamma distributions — gamma_shapescale2mucv • epitrix</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Reparameterise Gamma distributions — gamma_shapescale2mucv" />

<meta property="og:description" content="These functions permit to use alternate parametrisations for Gamma
distributions, from 'shape and scale' to 'mean (mu) and coefficient of
variation (cv), and back. gamma_shapescale2mucv does the first
conversion, while gamma_mucv2shapescale does the second. The function
gamma_log_likelihood is a shortcut for computing Gamma log-likelihood
with the alternative parametrisation (mean, cv). See 'details' for a guide of
which parametrisation to use." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">epitrix</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/epitrix.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Reparameterise Gamma distributions</h1>
    
    <div class="hidden name"><code>gamma_tools.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>These functions permit to use alternate parametrisations for Gamma
distributions, from 'shape and scale' to 'mean (mu) and coefficient of
variation (cv), and back. <code>gamma_shapescale2mucv</code> does the first
conversion, while <code>gamma_mucv2shapescale</code> does the second. The function
<code>gamma_log_likelihood</code> is a shortcut for computing Gamma log-likelihood
with the alternative parametrisation (mean, cv). See 'details' for a guide of
which parametrisation to use.</p>
    
    </div>

    <pre class="usage"><span class='fu'>gamma_shapescale2mucv</span>(<span class='no'>shape</span>, <span class='no'>scale</span>)

<span class='fu'>gamma_mucv2shapescale</span>(<span class='no'>mu</span>, <span class='no'>cv</span>)

<span class='fu'>gamma_log_likelihood</span>(<span class='no'>x</span>, <span class='no'>mu</span>, <span class='no'>cv</span>, <span class='kw'>discrete</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>interval</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>w</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>anchor</span> <span class='kw'>=</span> <span class='fl'>0.5</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>shape</th>
      <td><p>The shape parameter of the Gamma distribution.</p></td>
    </tr>
    <tr>
      <th>scale</th>
      <td><p>The scale parameter of the Gamma distribution.</p></td>
    </tr>
    <tr>
      <th>mu</th>
      <td><p>The mean of the Gamma distribution.</p></td>
    </tr>
    <tr>
      <th>cv</th>
      <td><p>The coefficient of variation of the Gamma distribution, i.e. the
standard deviation divided by the mean.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>A vector of data treated as observations drawn from a Gamma
distribution, for which the likelihood is to be computed.</p></td>
    </tr>
    <tr>
      <th>discrete</th>
      <td><p>A logical indicating if the distribution should be
discretised; TRUE by default.</p></td>
    </tr>
    <tr>
      <th>interval</th>
      <td><p>The interval used for discretisation; see
<code>distcrete</code>.</p></td>
    </tr>
    <tr>
      <th>w</th>
      <td><p>The centering of the interval used for discretisation, defaulting to
0; see <code>distcrete</code>.</p></td>
    </tr>
    <tr>
      <th>anchor</th>
      <td><p>The anchor used for discretisation, i.e. starting point of the
discretisation process; defaults to 0; see <code>distcrete</code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A named list containing 'shape' and 'scale', or mean ('mean') and
coefficient of variation ('cv').</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The gamma distribution is described in <code><a href='https://www.rdocumentation.org/packages/stats/topics/GammaDist'>?dgamma</a></code> is
parametrised using shape and scale (or rate). However, these parameters are
naturally correlated, which make them poor choices whenever trying to fit
data to a Gamma distribution. Their interpretation is also less clear than
the traditional mean and variance. When fitting the data, or reporting
results, it is best to use the alternative parametrisation using the mean
(<code>mu</code>) and the coefficient of variation (<code>cv</code>), i.e. the standard
deviation divided by the mean.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## set up some parameters</span>

<span class='no'>mu</span> <span class='kw'>&lt;-</span> <span class='fl'>10</span>
<span class='no'>cv</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span>


<span class='co'>## transform into shape scale</span>

<span class='no'>tmp</span> <span class='kw'>&lt;-</span> <span class='fu'>gamma_mucv2shapescale</span> (<span class='no'>mu</span>, <span class='no'>cv</span>)
<span class='no'>shape</span> <span class='kw'>&lt;-</span> <span class='no'>tmp</span>$<span class='no'>shape</span>
<span class='no'>scale</span> <span class='kw'>&lt;-</span> <span class='no'>tmp</span>$<span class='no'>scale</span>


<span class='co'>## recover original parameters when applying the revert function</span>

<span class='fu'>gamma_shapescale2mucv</span>(<span class='no'>shape</span>, <span class='no'>scale</span>) <span class='co'># compare with mu, cv</span></div><div class='output co'>#&gt; $mu
#&gt; [1] 10
#&gt; 
#&gt; $cv
#&gt; [1] 1
#&gt; </div><div class='input'>

<span class='co'>## empirical validation:</span>
<span class='co'>## check mean / cv of a sample derived using rgamma with</span>
<span class='co'>## shape and scale computed from mu and cv</span>

<span class='no'>gamma_sample</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/GammaDist'>rgamma</a></span>(<span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>10000</span>, <span class='kw'>shape</span> <span class='kw'>=</span> <span class='no'>shape</span>, <span class='kw'>scale</span> <span class='kw'>=</span> <span class='no'>scale</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/mean'>mean</a></span>(<span class='no'>gamma_sample</span>) <span class='co'># compare to mu</span></div><div class='output co'>#&gt; [1] 9.859027</div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/sd'>sd</a></span>(<span class='no'>gamma_sample</span>) / <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/mean'>mean</a></span>(<span class='no'>gamma_sample</span>) <span class='co'># compare to cv</span></div><div class='output co'>#&gt; [1] 1.001452</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Code by Anne Cori <a href='mailto:a.cori@imperial.ac.uk'>a.cori@imperial.ac.uk</a>, packaging by
Thibaut Jombart <a href='mailto:thibautjombart@gmail.com'>thibautjombart@gmail.com</a></p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Thibaut Jombart, Anne Cori.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

